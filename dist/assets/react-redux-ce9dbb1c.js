import{r as S}from"./react-dom-08dbd4e5.js";import{r as c,a as m}from"./react-4ec858dc.js";import"./hoist-non-react-statics-dd442a32.js";import"./react-is-d0c61868.js";import"./use-sync-external-store-9004a0ea.js";function y(t){t()}let b=y;const C=t=>b=t,g=()=>b,a=c.createContext(null);function v(){return c.useContext(a)}function w(){const t=g();let s=null,o=null;return{clear(){s=null,o=null},notify(){t(()=>{let e=s;for(;e;)e.callback(),e=e.next})},get(){let e=[],r=s;for(;r;)e.push(r),r=r.next;return e},subscribe(e){let r=!0,n=o={callback:e,next:null,prev:o};return n.prev?n.prev.next=n:s=n,function(){!r||s===null||(r=!1,n.next?n.next.prev=n.prev:o=n.prev,n.prev?n.prev.next=n.next:s=n.next)}}}}const d={notify(){},get:()=>[]};function E(t,s){let o,e=d;function r(h){return f(),e.subscribe(h)}function n(){e.notify()}function i(){l.onStateChange&&l.onStateChange()}function u(){return Boolean(o)}function f(){o||(o=s?s.addNestedSub(i):t.subscribe(i),e=w())}function x(){o&&(o(),o=void 0,e.clear(),e=d)}const l={addNestedSub:r,notifyNestedSubs:n,handleChangeWrapper:i,isSubscribed:u,trySubscribe:f,tryUnsubscribe:x,getListeners:()=>e};return l}const N=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",D=N?c.useLayoutEffect:c.useEffect;function V({store:t,context:s,children:o,serverState:e}){const r=c.useMemo(()=>{const u=E(t);return{store:t,subscription:u,getServerState:e?()=>e:void 0}},[t,e]),n=c.useMemo(()=>t.getState(),[t]);D(()=>{const{subscription:u}=r;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),n!==t.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[r,n]);const i=s||a;return m.createElement(i.Provider,{value:r},o)}function p(t=a){const s=t===a?v:()=>c.useContext(t);return function(){const{store:e}=s();return e}}const L=p();function R(t=a){const s=t===a?L:p(t);return function(){return s().dispatch}}const H=R();C(S.unstable_batchedUpdates);export{V as P,H as u};
